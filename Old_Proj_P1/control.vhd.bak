library IEEE;
use IEEE.std_logic_1164.all;
use IEEE.numeric_std.all;

entity control is 
  port (
        i_opcode : in std_logic_vector(6 downto 0);
        i_funct3 : in std_logic_vector(2 downto 0);
	i_funct7 : in std_logic_vector(6 downto 0);
	o_ALUSRC : out std_logic;
        o_ALUControl : out std_logic_vector(3 downto 0);
        o_ImmType : out std_logic_vector(2 downto 0);
	o_ResultSrc : out std_logic_vector(1 downto 0);
	o_Mem_Write : out std_logic;
	o_RegWrite : out std_logic;
	o_imm_sel : out std_logic_vector(1 downto 0);
	o_BranchType: out std_logic_vector(1 downto 0)
        
);
end control;

architecture dataflow of control is
begin

o_ALUSRC <= - when (i_opcode = "0101100") else 
1 when (i_opcode = "0010011") else 
0 when (i_opcode = "0110011") else 
1 when (i_opcode = "0110111") else 
1 when (i_opcode = "0000011") else 
1 when (i_opcode = "1100011") else 
1 when (i_opcode = "1101111") else 
1 when (i_opcode = "1100111") else 
1 when (i_opcode = "0010111")

o_ALUControl <= - when (i_opcode = "0101100") else 
0010 when (i_opcode = "0010011" and i_funct3 = "000") else 
0000 when (i_opcode = "0010011" and i_funct3 = "111") else 
0011 when (i_opcode = "0010011" and i_funct3 = "100") else 
0001 when (i_opcode = "0010011" and i_funct3 = "110") else 
1000 when (i_opcode = "0010011" and i_funct3 = "010") else 
1001 when (i_opcode = "0010011" and i_funct3 = "011") else 
0100 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
0101 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
0111 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

0010 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
0000 when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
0011 when (i_opcode = "0110011" and i_funct3 = "100") else 
0001 when (i_opcode = "0110011" and i_funct3 = "110") else 
1000 when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
0100 when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
0101 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
0111 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
0110 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

0001 when (i_opcode = "0110111") else 

0010 when (i_opcode = "0000011" and i_funct3 = "010") else 
0010 when (i_opcode = "0000011" and i_funct3 = "000") else 
0010 when (i_opcode = "0000011" and i_funct3 = "001") else 
0010 when (i_opcode = "0000011" and i_funct3 = "100") else 
0010 when (i_opcode = "0000011" and i_funct3 = "101") else 

0110 when (i_opcode = "1100011" and i_funct3 = "000") else 
0110 when (i_opcode = "1100011" and i_funct3 = "001") else 
0110 when (i_opcode = "1100011" and i_funct3 = "100") else 
0110 when (i_opcode = "1100011" and i_funct3 = "101") else 
0110 when (i_opcode = "1100011" and i_funct3 = "110") else 
0110 when (i_opcode = "1100011" and i_funct3 = "111") else 

0010 when (i_opcode = "1101111") else 
0010 when (i_opcode = "1100111") else 

0010 when (i_opcode = "0010111")  

o_ImmType <= - when (i_opcode = "0101100") else 
- when (i_opcode = "0010011" and i_funct3 = "000") else 
000 when (i_opcode = "0010011" and i_funct3 = "111") else 
000 when (i_opcode = "0010011" and i_funct3 = "100") else 
000 when (i_opcode = "0010011" and i_funct3 = "110") else 
000 when (i_opcode = "0010011" and i_funct3 = "010") else 
000 when (i_opcode = "0010011" and i_funct3 = "011") else 
000 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
000 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
000 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

- when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "100") else 
- when (i_opcode = "0110011" and i_funct3 = "110") else 
000 when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
000 when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
000 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
000 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
000 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

000 when (i_opcode = "0110111") else 

000 when (i_opcode = "0000011" and i_funct3 = "010") else 
000 when (i_opcode = "0000011" and i_funct3 = "000") else 
000 when (i_opcode = "0000011" and i_funct3 = "001") else 
000 when (i_opcode = "0000011" and i_funct3 = "100") else 
000 when (i_opcode = "0000011" and i_funct3 = "101") else 

010 when (i_opcode = "1100011" and i_funct3 = "000") else 
010 when (i_opcode = "1100011" and i_funct3 = "001") else 
010 when (i_opcode = "1100011" and i_funct3 = "100") else 
010 when (i_opcode = "1100011" and i_funct3 = "101") else 
010 when (i_opcode = "1100011" and i_funct3 = "110") else 
010 when (i_opcode = "1100011" and i_funct3 = "111") else 

100 when (i_opcode = "1101111") else 
000 when (i_opcode = "1100111") else 

011 when (i_opcode = "0010111")  

o_ResultSrc <= - when (i_opcode = "0101100") else 
00 when (i_opcode = "0010011" and i_funct3 = "000") else 
00 when (i_opcode = "0010011" and i_funct3 = "111") else 
00 when (i_opcode = "0010011" and i_funct3 = "100") else 
00 when (i_opcode = "0010011" and i_funct3 = "110") else 
00 when (i_opcode = "0010011" and i_funct3 = "010") else 
00 when (i_opcode = "0010011" and i_funct3 = "011") else 
00 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
00 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
00 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

00 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
00 when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
00 when (i_opcode = "0110011" and i_funct3 = "100") else 
00 when (i_opcode = "0110011" and i_funct3 = "110") else 
00 when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
00 when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
00 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
00 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
00 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

00 when (i_opcode = "0110111") else 

01 when (i_opcode = "0000011" and i_funct3 = "010") else 
01 when (i_opcode = "0000011" and i_funct3 = "000") else 
01 when (i_opcode = "0000011" and i_funct3 = "001") else 
01 when (i_opcode = "0000011" and i_funct3 = "100") else 
01 when (i_opcode = "0000011" and i_funct3 = "101") else 

- when (i_opcode = "1100011" and i_funct3 = "000") else 
- when (i_opcode = "1100011" and i_funct3 = "001") else 
- when (i_opcode = "1100011" and i_funct3 = "100") else 
- when (i_opcode = "1100011" and i_funct3 = "101") else 
- when (i_opcode = "1100011" and i_funct3 = "110") else 
- when (i_opcode = "1100011" and i_funct3 = "111") else 

10 when (i_opcode = "1101111") else 
10 when (i_opcode = "1100111") else 

00 when (i_opcode = "0010111")  

o_MemWrite <= 0 when (i_opcode = "0101100") else 
0 when (i_opcode = "0010011" and i_funct3 = "000") else 
0 when (i_opcode = "0010011" and i_funct3 = "111") else 
0 when (i_opcode = "0010011" and i_funct3 = "100") else 
0 when (i_opcode = "0010011" and i_funct3 = "110") else 
0 when (i_opcode = "0010011" and i_funct3 = "010") else 
0 when (i_opcode = "0010011" and i_funct3 = "011") else 
0 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
0 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
0 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

0 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "100") else 
0 when (i_opcode = "0110011" and i_funct3 = "110") else 
0 when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
0 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

0 when (i_opcode = "0110111") else 

0 when (i_opcode = "0000011" and i_funct3 = "010") else 
0 when (i_opcode = "0000011" and i_funct3 = "000") else 
0 when (i_opcode = "0000011" and i_funct3 = "001") else 
0 when (i_opcode = "0000011" and i_funct3 = "100") else 
0 when (i_opcode = "0000011" and i_funct3 = "101") else 

0 when (i_opcode = "1100011" and i_funct3 = "000") else 
0 when (i_opcode = "1100011" and i_funct3 = "001") else 
0 when (i_opcode = "1100011" and i_funct3 = "100") else 
0 when (i_opcode = "1100011" and i_funct3 = "101") else 
0 when (i_opcode = "1100011" and i_funct3 = "110") else 
0 when (i_opcode = "1100011" and i_funct3 = "111") else 

0 when (i_opcode = "1101111") else 
0 when (i_opcode = "1100111") else 

0 when (i_opcode = "0010111")  

o_RegWrite <= 0 when (i_opcode = "0101100") else 
1 when (i_opcode = "0010011" and i_funct3 = "000") else 
1 when (i_opcode = "0010011" and i_funct3 = "111") else 
1 when (i_opcode = "0010011" and i_funct3 = "100") else 
1 when (i_opcode = "0010011" and i_funct3 = "110") else 
1 when (i_opcode = "0010011" and i_funct3 = "010") else 
1 when (i_opcode = "0010011" and i_funct3 = "011") else 
1 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
1 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
1 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

1 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
1 when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
1 when (i_opcode = "0110011" and i_funct3 = "100") else 
1 when (i_opcode = "0110011" and i_funct3 = "110") else 
1 when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
1 when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
1 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
1 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
1 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

1 when (i_opcode = "0110111") else 

1 when (i_opcode = "0000011" and i_funct3 = "010") else 
1 when (i_opcode = "0000011" and i_funct3 = "000") else 
1 when (i_opcode = "0000011" and i_funct3 = "001") else 
1 when (i_opcode = "0000011" and i_funct3 = "100") else 
1 when (i_opcode = "0000011" and i_funct3 = "101") else 

0 when (i_opcode = "1100011" and i_funct3 = "000") else 
0 when (i_opcode = "1100011" and i_funct3 = "001") else 
0 when (i_opcode = "1100011" and i_funct3 = "100") else 
0 when (i_opcode = "1100011" and i_funct3 = "101") else 
0 when (i_opcode = "1100011" and i_funct3 = "110") else 
0 when (i_opcode = "1100011" and i_funct3 = "111") else 

0 when (i_opcode = "1101111") else 
0 when (i_opcode = "1100111") else 

1 when (i_opcode = "0010111")  

o_imm_sel <= - when (i_opcode = "0101100") else 
01 when (i_opcode = "0010011" and i_funct3 = "000") else 
00 when (i_opcode = "0010011" and i_funct3 = "111") else 
00 when (i_opcode = "0010011" and i_funct3 = "100") else 
00 when (i_opcode = "0010011" and i_funct3 = "110") else 
01 when (i_opcode = "0010011" and i_funct3 = "010") else 
01 when (i_opcode = "0010011" and i_funct3 = "011") else 
00 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
00 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
00 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

- when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "100") else 
- when (i_opcode = "0110011" and i_funct3 = "110") else 
- when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
01 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

10 when (i_opcode = "0110111") else 

01 when (i_opcode = "0000011" and i_funct3 = "010") else 
01 when (i_opcode = "0000011" and i_funct3 = "000") else 
01 when (i_opcode = "0000011" and i_funct3 = "001") else 
01 when (i_opcode = "0000011" and i_funct3 = "100") else 
01 when (i_opcode = "0000011" and i_funct3 = "101") else 

01 when (i_opcode = "1100011" and i_funct3 = "000") else 
01 when (i_opcode = "1100011" and i_funct3 = "001") else 
01 when (i_opcode = "1100011" and i_funct3 = "100") else 
01 when (i_opcode = "1100011" and i_funct3 = "101") else 
00 when (i_opcode = "1100011" and i_funct3 = "110") else 
00 when (i_opcode = "1100011" and i_funct3 = "111") else 

01 when (i_opcode = "1101111") else 
01 when (i_opcode = "1100111") else 

10 when (i_opcode = "0010111")  

o_Branch <= - when (i_opcode = "0101100") else 
- when (i_opcode = "0010011" and i_funct3 = "000") else 
- when (i_opcode = "0010011" and i_funct3 = "111") else 
- when (i_opcode = "0010011" and i_funct3 = "100") else 
- when (i_opcode = "0010011" and i_funct3 = "110") else 
- when (i_opcode = "0010011" and i_funct3 = "010") else 
- when (i_opcode = "0010011" and i_funct3 = "011") else 
- when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
- when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
- when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

- when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "100") else 
- when (i_opcode = "0110011" and i_funct3 = "110") else 
- when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
- when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
- when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

- when (i_opcode = "0110111") else 

- when (i_opcode = "0000011" and i_funct3 = "010") else 
- when (i_opcode = "0000011" and i_funct3 = "000") else 
- when (i_opcode = "0000011" and i_funct3 = "001") else 
- when (i_opcode = "0000011" and i_funct3 = "100") else 
- when (i_opcode = "0000011" and i_funct3 = "101") else 

00 when (i_opcode = "1100011" and i_funct3 = "000") else 
01 when (i_opcode = "1100011" and i_funct3 = "001") else 
10 when (i_opcode = "1100011" and i_funct3 = "100") else 
11 when (i_opcode = "1100011" and i_funct3 = "101") else 
01 when (i_opcode = "1100011" and i_funct3 = "110") else 
11 when (i_opcode = "1100011" and i_funct3 = "111") else 

- when (i_opcode = "1101111") else 
- when (i_opcode = "1100111") else 

- when (i_opcode = "0010111")  

o_Jump <= 0 when (i_opcode = "0101100") else 
0 when (i_opcode = "0010011" and i_funct3 = "000") else 
0 when (i_opcode = "0010011" and i_funct3 = "111") else 
0 when (i_opcode = "0010011" and i_funct3 = "100") else 
0 when (i_opcode = "0010011" and i_funct3 = "110") else 
0 when (i_opcode = "0010011" and i_funct3 = "010") else 
0 when (i_opcode = "0010011" and i_funct3 = "011") else 
0 when (i_opcode = "0010011" and i_funct3 = "001" and funct7 = "0000000") else 
0 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0000000") else 
0 when (i_opcode = "0010011" and i_funct3 = "101" and funct7 = "0100000") else 

0 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "111" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "100") else 
0 when (i_opcode = "0110011" and i_funct3 = "110") else 
0 when (i_opcode = "0110011" and i_funct3 = "010" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "001" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0000000") else 
0 when (i_opcode = "0110011" and i_funct3 = "101" and funct7 = "0100000") else 
0 when (i_opcode = "0110011" and i_funct3 = "000" and funct7 = "0100000") else 

0 when (i_opcode = "0110111") else 

0 when (i_opcode = "0000011" and i_funct3 = "010") else 
0 when (i_opcode = "0000011" and i_funct3 = "000") else 
0 when (i_opcode = "0000011" and i_funct3 = "001") else 
0 when (i_opcode = "0000011" and i_funct3 = "100") else 
0 when (i_opcode = "0000011" and i_funct3 = "101") else 

0 when (i_opcode = "1100011" and i_funct3 = "000") else 
0 when (i_opcode = "1100011" and i_funct3 = "001") else 
0 when (i_opcode = "1100011" and i_funct3 = "100") else 
0 when (i_opcode = "1100011" and i_funct3 = "101") else 
0 when (i_opcode = "1100011" and i_funct3 = "110") else 
0 when (i_opcode = "1100011" and i_funct3 = "111") else 

1 when (i_opcode = "1101111") else 
1 when (i_opcode = "1100111") else 

0 when (i_opcode = "0010111")  

end dataflow;